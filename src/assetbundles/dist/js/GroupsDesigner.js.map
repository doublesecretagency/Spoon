{"version":3,"file":"/dist/js/GroupsDesigner.js","mappings":"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","sources":["webpack:///./src/GroupsDesigner.js"],"sourcesContent":["/**\n * Spoon plugin for Craft CMS\n *\n * @copyright Copyright (c) 2018, 2022 Double Secret Agency\n * @link      https://plugins.doublesecretagency.com/\n * @package   Spoon\n * @since     3.0.0\n */\n(function($){\n\n    if (typeof Spoon == 'undefined')\n    {\n        Spoon = {};\n    }\n\n    // noinspection JSVoidFunctionReturnValueUsed\n    Spoon.GroupsDesigner = Craft.FieldLayoutDesigner.extend(\n        {\n\n            $form: null,\n            $spinner: null,\n\n            modal: null,\n\n            initElement: function($element) {\n                // Base init\n                new Craft.FieldLayoutDesigner.Element(this, $element);\n\n                // Add our settings button\n                var $editBtn = $('<a/>', {\n                    role: 'button',\n                    tabindex: 0,\n                    class: 'settings icon',\n                    title: Craft.t('app', 'Edit')\n                });\n\n\n                // THIS IS THE BUTTON YOU WANT TO IMITATE?\n\n\n                $editBtn.on('click', $.proxy(function() {\n                    this.onEditFieldLayout($element, $editBtn);\n                }, this));\n\n                $editBtn.appendTo($element);\n            },\n\n            // // cloned for language adjustments\n            // renameTab: function($tab)\n            // {\n            //     if (!this.settings.customizableTabs) {\n            //         return;\n            //     }\n            //\n            //     var $labelSpan = $tab.find('.tabs .tab span');\n            //     var oldName = $labelSpan.text();\n            //     var newName = prompt(Craft.t('app', 'Give your group a name.'), oldName);\n            //\n            //     if (newName && newName !== oldName) {\n            //         $labelSpan.text(newName);\n            //         $tab.find('.placement-input').attr('name', this.getElementPlacementInputName(newName));\n            //     }\n            // },\n\n            // cloned for language adjustments\n            addTab: function()\n            {\n                if (!this.settings.customizableTabs) {\n                    return;\n                }\n\n                var $tab = $(\n'<div class=\"fld-tab\">' +\n  '<div class=\"tabs\">' +\n    '<div class=\"tab sel draggable\">' +\n      '<span>Group '+ (this.tabGrid.$items.length + 1) +'</span>' +\n      '<a class=\"settings icon\" title=\"'+Craft.t('app', 'Rename')+'\"></a>' +\n    '</div>' +\n  '</div>' +\n  '<div class=\"fld-tabcontent\"></div>' +\n'</div>')\n                    .appendTo(this.$tabContainer);\n\n                this.tabGrid.addItems($tab);\n                this.tabDrag.addItems($tab);\n\n                this.initTab($tab);\n            },\n\n            /**\n             * When trying to edit a field layout make sure the\n             * block groups have saved first\n             */\n            onEditFieldLayout: function($blockType, $btn)\n            {\n                if ($btn.hasClass('disabled')) {\n                    return;\n                }\n\n                $btn.addClass('disabled');\n\n                var $modalForm = $blockType.parents('.modal');\n\n                $modalForm.one('blockTypesSaved', $.proxy(function()\n                {\n                    this.editFieldLayout($blockType);\n                }, this));\n\n                $modalForm.trigger('submit');\n            },\n\n            /**\n             * This pops open another modal with another fld in it to enable\n             * the editing of fields and tabs to happen inside the block type\n             */\n            editFieldLayout: function($blockType)\n            {\n\n                // Build the markup\n                this.$form = $('<form class=\"modal elementselectormodal spoon-fields-configurator\"/>');\n\n                var $body = $('<div class=\"body\"/>').appendTo(this.$form),\n                    $body = $('<div class=\"content\"/>').appendTo($body),\n                    $bigSpinner = $('<div class=\"spinner big\"/>').appendTo($body),\n                    $body = $('<div class=\"main\"/>').appendTo($body),\n                    $footer = $('<div class=\"footer\"/>').appendTo(this.$form),\n                    $buttons = $('<div class=\"buttons right\"/>').appendTo($footer);\n\n                var $cancelBtn = $('<div class=\"btn\">'+Craft.t('app', 'Cancel')+'</div>').appendTo($buttons),\n                    $submitBtn = $('<input type=\"submit\" class=\"btn submit\" value=\"'+Craft.t('app', 'Save')+'\"/>').appendTo($buttons);\n\n                this.$spinner = $('<div class=\"spinner hidden\"/>').appendTo($buttons);\n\n                this.modal = new Garnish.Modal(this.$form,\n                    {\n                        resizable: true,\n                        closeOtherModals: false,\n                        onFadeIn: $.proxy(function()\n                        {\n\n                            var data = {\n                                context : this.settings.context,\n                                blockTypeId : $blockType.data('id')\n                            };\n\n                            Craft.postActionRequest('spoon/configurator/get-fields-html', data, $.proxy(function(response, textStatus)\n                            {\n                                if (textStatus === 'success')\n                                {\n                                    $(response.html).appendTo($body);\n                                    $bigSpinner.addClass('hidden');\n\n                                    // var fld = new Craft.FieldLayoutDesigner('#spoon-fields-configurator', {\n                                    //     customizableTabs: true,\n                                    //     customizableUi: false,\n                                    // });\n                                }\n                            }, this));\n\n                        }, this),\n                        onHide: $.proxy(function()\n                        {\n                            this.modal.$container.remove();\n                            this.modal.$shade.remove();\n                            delete this;\n                        }, this)\n                    });\n\n                this.addListener(this.$form, 'submit', '_handleSubmit');\n                this.addListener($cancelBtn, 'click', $.proxy(function()\n                {\n                    this.modal.hide();\n                }, this));\n            },\n\n            _handleSubmit: function(ev)\n            {\n                ev.preventDefault();\n\n                // Show spinner\n                this.$spinner.removeClass('hidden');\n\n                // Get the form data\n                var data = this.$form.serialize();\n\n                // Post it\n                Craft.postActionRequest('spoon/block-types/save-field-layout', data, $.proxy(function(response, textStatus)\n                {\n                    this.$spinner.addClass('hidden');\n                    if (textStatus === 'success' && response.success)\n                    {\n                        Craft.cp.displayNotice(Craft.t('app', 'Field layout saved.'));\n                        this.modal.hide();\n                    }\n                    else\n                    {\n                        if (textStatus === 'success')\n                        {\n                            Craft.cp.displayError(Craft.t('app', 'An unknown error occurred.'));\n                        }\n                    }\n                }, this));\n            }\n\n        });\n\n})(jQuery);\n"],"names":["$","Spoon","GroupsDesigner","Craft","FieldLayoutDesigner","extend","$form","$spinner","modal","initElement","$element","Element","$editBtn","role","tabindex","title","t","on","proxy","onEditFieldLayout","appendTo","addTab","settings","customizableTabs","$tab","tabGrid","$items","length","$tabContainer","addItems","tabDrag","initTab","$blockType","$btn","hasClass","addClass","$modalForm","parents","one","editFieldLayout","trigger","$body","$bigSpinner","$footer","$buttons","$cancelBtn","$submitBtn","Garnish","Modal","resizable","closeOtherModals","onFadeIn","data","context","blockTypeId","postActionRequest","response","textStatus","html","onHide","$container","remove","$shade","addListener","hide","_handleSubmit","ev","preventDefault","removeClass","serialize","success","cp","displayNotice","displayError","jQuery"],"sourceRoot":""}